<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{layout/base :: layout(~{::title}, ~{::section})}">
<head>
    <title>Register Vehicle - Taxi Booking System</title>
</head>
<body>
    <section class="container py-4">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <!-- Header -->
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2>Register New Vehicle</h2>
                    <a th:href="@{/vehicles}" class="btn btn-outline-secondary">
                        <i class="bi bi-arrow-left me-2"></i>Back to Vehicles
                    </a>
                </div>
                
                <!-- Registration Form -->
                <div class="card shadow">
                    <div class="card-body">
                        <form th:action="@{/vehicles/register}" th:object="${vehicle}" method="post" class="needs-validation" novalidate>
                            <!-- Basic Information -->
                            <h5 class="card-title mb-4">Basic Information</h5>
                            <div class="row g-3">
                                <!-- License Plate -->
                                <div class="col-md-6">
                                    <label for="licensePlate" class="form-label">License Plate</label>
                                    <input type="text" class="form-control" id="licensePlate" 
                                           th:field="*{licensePlate}" required
                                           pattern="[A-Z0-9-]+" 
                                           title="Please enter a valid license plate (uppercase letters, numbers, and hyphens)">
                                    <div class="invalid-feedback">
                                        Please enter a valid license plate.
                                    </div>
                                </div>
                                
                                <!-- Vehicle Type -->
                                <div class="col-md-6">
                                    <label for="vehicleType" class="form-label">Vehicle Type</label>
                                    <select class="form-select" id="vehicleType" th:field="*{vehicleType}" required
                                            onchange="updateVehicleTypeFields()">
                                        <option value="">Choose type...</option>
                                        <option th:each="type : ${vehicleTypes}" th:value="${type}" th:text="${type}">
                                        </option>
                                    </select>
                                    <div class="invalid-feedback">
                                        Please select a vehicle type.
                                    </div>
                                </div>
                                
                                <!-- Make -->
                                <div class="col-md-6">
                                    <label for="make" class="form-label">Make</label>
                                    <input type="text" class="form-control" id="make" 
                                           th:field="*{make}" required>
                                    <div class="invalid-feedback">
                                        Please enter the vehicle make.
                                    </div>
                                </div>
                                
                                <!-- Model -->
                                <div class="col-md-6">
                                    <label for="model" class="form-label">Model</label>
                                    <input type="text" class="form-control" id="model" 
                                           th:field="*{model}" required>
                                    <div class="invalid-feedback">
                                        Please enter the vehicle model.
                                    </div>
                                </div>
                                
                                <!-- Year -->
                                <div class="col-md-4">
                                    <label for="year" class="form-label">Year</label>
                                    <input type="number" class="form-control" id="year" 
                                           th:field="*{year}" required min="1900" 
                                           th:max="${#dates.year(#dates.createNow())}">
                                    <div class="invalid-feedback">
                                        Please enter a valid year.
                                    </div>
                                </div>
                                
                                <!-- Color -->
                                <div class="col-md-4">
                                    <label for="color" class="form-label">Color</label>
                                    <input type="text" class="form-control" id="color" 
                                           th:field="*{color}" required>
                                    <div class="invalid-feedback">
                                        Please enter the vehicle color.
                                    </div>
                                </div>
                                
                                <!-- Capacity -->
                                <div class="col-md-4">
                                    <label for="capacity" class="form-label">Capacity (seats)</label>
                                    <input type="number" class="form-control" id="capacity" 
                                           th:field="*{capacity}" required min="2" max="20">
                                    <div class="invalid-feedback">
                                        Please enter a valid capacity (2-20 seats).
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Type-Specific Features -->
                            <h5 class="card-title mt-5 mb-4">Vehicle Features</h5>
                            
                            <!-- Premium Vehicle Features -->
                            <div id="premiumFeatures" class="d-none">
                                <div class="row g-3">
                                    <div class="col-md-4">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" 
                                                   id="hasLeatherSeats" name="hasLeatherSeats">
                                            <label class="form-check-label" for="hasLeatherSeats">
                                                Leather Seats
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" 
                                                   id="hasSunroof" name="hasSunroof">
                                            <label class="form-check-label" for="hasSunroof">
                                                Sunroof
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" 
                                                   id="hasPremiumAudio" name="hasPremiumAudio">
                                            <label class="form-check-label" for="hasPremiumAudio">
                                                Premium Audio
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Van Vehicle Features -->
                            <div id="vanFeatures" class="d-none">
                                <div class="row g-3">
                                    <div class="col-md-4">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" 
                                                   id="hasWheelchairAccess" name="hasWheelchairAccess">
                                            <label class="form-check-label" for="hasWheelchairAccess">
                                                Wheelchair Access
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" 
                                                   id="hasLuggageRack" name="hasLuggageRack">
                                            <label class="form-check-label" for="hasLuggageRack">
                                                Luggage Rack
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <label for="cargoCapacity" class="form-label">Cargo Capacity (mÂ³)</label>
                                        <input type="number" class="form-control" id="cargoCapacity" 
                                               name="cargoCapacity" min="1" max="20" step="0.1">
                                        <div class="invalid-feedback">
                                            Please enter a valid cargo capacity.
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Base Rate -->
                            <div class="mt-4">
                                <label for="baseRate" class="form-label">Base Rate (per km)</label>
                                <div class="input-group">
                                    <span class="input-group-text">$</span>
                                    <input type="number" class="form-control" id="baseRate" 
                                           th:field="*{baseRate}" required min="0.1" step="0.1">
                                    <div class="invalid-feedback">
                                        Please enter a valid base rate.
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Additional Notes -->
                            <div class="mt-4">
                                <label for="notes" class="form-label">Additional Notes</label>
                                <textarea class="form-control" id="notes" th:field="*{notes}" 
                                          rows="3" placeholder="Enter any additional information about the vehicle..."></textarea>
                            </div>
                            
                            <!-- Submit Button -->
                            <div class="mt-5">
                                <button type="submit" class="btn btn-primary">
                                    <i class="bi bi-check-circle me-2"></i>Register Vehicle
                                </button>
                                <a th:href="@{/vehicles}" class="btn btn-link">Cancel</a>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <script th:inline="javascript">
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize form validation
            const form = document.querySelector('.needs-validation');
            form.addEventListener('submit', function(event) {
                if (!form.checkValidity()) {
                    event.preventDefault();
                    event.stopPropagation();
                }
                form.classList.add('was-validated');
            });
            
            // Update vehicle type fields
            updateVehicleTypeFields();
        });
        
        function updateVehicleTypeFields() {
            const vehicleType = document.getElementById('vehicleType').value;
            const premiumFeatures = document.getElementById('premiumFeatures');
            const vanFeatures = document.getElementById('vanFeatures');
            
            // Hide all type-specific features
            premiumFeatures.classList.add('d-none');
            vanFeatures.classList.add('d-none');
            
            // Show relevant features based on vehicle type
            switch (vehicleType) {
                case 'PREMIUM':
                    premiumFeatures.classList.remove('d-none');
                    break;
                case 'VAN':
                    vanFeatures.classList.remove('d-none');
                    break;
            }
            
            // Update base rate based on vehicle type
            const baseRateInput = document.getElementById('baseRate');
            switch (vehicleType) {
                case 'ECONOMY':
                    baseRateInput.value = '1.0';
                    break;
                case 'PREMIUM':
                    baseRateInput.value = '1.5';
                    break;
                case 'VAN':
                    baseRateInput.value = '1.8';
                    break;
                default:
                    baseRateInput.value = '';
            }
        }
    </script>
</body>
</html> 